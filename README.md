# üèÜ Top 1 solution ‚Äî ITMO ASR

### ASR - Numbers Recognition in Russian

[–°—Å—ã–ª–∫–∞ –Ω–∞ Kaggle —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–µ](https://www.kaggle.com/competitions/asr-numbers-recognition-in-russian/leaderboard)

---

## üìä –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

<img width="1188" alt="image" src="https://github.com/user-attachments/assets/f532358d-1e9f-4ef3-9b87-f5899519978a" />

| –ú–æ–¥–µ–ª—å                | Private Score üîí | Public Score üåê | –û–ø–∏—Å–∞–Ω–∏–µ                                         |
|-----------------------|------------------|-----------------|--------------------------------------------------|
| `predictions (5).csv` | **16.765**       | **15.437**      | üìà –î–æ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –≤—Ç–æ—Ä–æ–π —Ç–µ—Ç—Ä–∞–¥–∫–µ (–≤–µ—Ä–æ—è—Ç–Ω–æ –ø—Ä–µ–¥–µ–ª) |
| `predictions (4).csv` | 17.825           | 16.624          | üåô –ù–æ—á–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ                                 |
| `predictions (3).csv` | 21.692           | 19.519          | üîª Negative drop                                   |

> üí° –§–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (`predictions (5).csv`) –∑–∞–Ω—è–ª–æ **1 –º–µ—Å—Ç–æ –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–º –ª–∏–¥–µ—Ä–±–æ—Ä–¥–µ**.

---

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

- **–ú–æ–¥–µ–ª—å:** CNN ‚û°Ô∏è BiLSTM ‚û°Ô∏è Linear ‚û°Ô∏è `log_softmax`
- **Loss:** CTC Loss (–Ω–∞ –≤—ã—Ö–æ–¥ –º–æ–¥–µ–ª–∏ –ø–æ–¥–∞—é—Ç—Å—è `log_softmax` logits)
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
  - –í—Å–µ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: **2,818,635**
  - –û–±—É—á–∞–µ–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: **2,818,635**

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

#### CNN Encoder
- `Conv2d(1, 32, kernel_size=3, padding=1)` ‚û°Ô∏è ReLU ‚û°Ô∏è MaxPool2d(kernel_size=(2,1))
- `Conv2d(32, 64, kernel_size=3, padding=1)` ‚û°Ô∏è ReLU ‚û°Ô∏è MaxPool2d(kernel_size=(2,1))
- `Conv2d(64, 64, kernel_size=3, padding=1)` ‚û°Ô∏è ReLU ‚û°Ô∏è MaxPool2d(kernel_size=(2,1))

#### BiLSTM Head
- Input size: 1024 (`64 * 16`) ‚Äî –ø–æ—Å–ª–µ CNN —Å–≤—ë—Ä—Ç–æ–∫ –∏ `MaxPool`
- Hidden size: 192
- Layers: 2
- Bidirectional: ‚úÖ
- Dropout: 0.3

#### Classifier
- `Linear(384, vocab_size)`
- `log_softmax(dim=2)` –≤–Ω—É—Ç—Ä–∏ `forward`

---

## üîÑ –≠—Ç–∞–ø—ã –æ–±—É—á–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (`train_submission.ipynb`)
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–º–∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è–º–∏.
- –ú–Ω–æ–≥–æ—á–∞—Å–æ–≤–æ–π –Ω–æ—á–Ω–æ–π –ø—Ä–æ–≥–æ–Ω.
- Early stopping –ø–æ –ø—Ä–∏–≤–∞—Ç–Ω–æ–π –º–µ—Ç—Ä–∏–∫–µ.

### –§–∏–Ω–∞–ª—å–Ω–æ–µ –¥–æ–æ–±—É—á–µ–Ω–∏–µ (`aftertraining.ipynb`)
- Fine-tune –Ω–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ (`–≤—Ç–æ—Ä–∞—è —Ç–µ—Ç—Ä–∞–¥–∫–∞`).
- –ü–æ–Ω–∏–∂–µ–Ω–Ω—ã–π learning rate.
- –î–æ–æ–±—É—á–µ–Ω–∏–µ –æ—Ç checkpoint –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ (`ckpts/model_finetuned_30ep.pth`).

---

## üìú –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

- `aftertraining.ipynb` ‚Äî –¥–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (—Ñ–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫–ø–æ–∏–Ω—Ç –¥–ª—è `predictions (5).csv`)
- `train_submission.ipynb` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (—á–µ–∫–ø–æ–∏–Ω—Ç –¥–ª—è `predictions (4).csv`)

